(function(){function t(t){t.style.top=window.pageYOffset+.5*window.innerHeight+"px"}function e(t){var e=t.nextElementSibling;e?t.parentNode.insertBefore(t.xtag.overlayElement,e):t.parentNode.appendChild(t.xtag.overlayElement)}var i=/OS [1-4]_\d like Mac OS X/i.test(navigator.userAgent),n=/Android 2.\d.+AppleWebKit/.test(navigator.userAgent);if(/Android 2\.3.+AppleWebKit/.test(navigator.userAgent),n){var o=document.createElement("meta");o.name="viewport",o.content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;",document.head.appendChild(o)}window.addEventListener("keyup",function(t){27==t.keyCode&&xtag.query(document,"x-modal[escape-hide]:not([hidden])").forEach(function(t){t.hide()})}),(i||n)&&window.addEventListener("scroll",function(){xtag.query(document,"body > x-modal").forEach(t)}),xtag.addEvent(document,"tapstart:delegate(x-modal-overlay)",function(){this.__overlayTapstart__=!0}),xtag.addEvent(document,"tapend:delegate(x-modal-overlay)",function(){var t=this.__modal__;this.__overlayTapstart__&&t&&t.hasAttribute("overlay-tap-hide")&&(t.hide(),this.__overlayTapstart__=!1)}),xtag.register("x-modal",{lifecycle:{created:function(){this.xtag.overlayElement=document.createElement("x-modal-overlay"),this.xtag.overlayElement.__modal__=this},inserted:function(){(i||n)&&t(this),this.xtag.lastParent=this.parentNode,e(this)},removed:function(){this.xtag.lastParent&&this.xtag.lastParent.removeChild(this.xtag.overlayElement),this.xtag.lastParent=null}},events:{reveal:function(){this.show()}},accessors:{overlay:{attribute:{"boolean":!0},set:function(){var t=this.className;this.className+=" x-modal-safari-redraw-bug",this.className=t}},escapeHide:{attribute:{"boolean":!0,name:"escape-hide"}},overlayTapHide:{attribute:{"boolean":!0,name:"overlay-tap-hide"}}},methods:{"show:transition(before)":function(){this.removeAttribute("hidden")},"hide:transition(after)":function(){this.setAttribute("hidden","")},toggle:function(){this[this.hasAttribute("hidden")&&"show"||"hide"]()}}})})();